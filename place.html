<!doctype html>
<html>
  <head>
    <title>WTD ‚Äì Place</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <a href="index.html">‚Üê Back</a>

      <div class="d-flex align-items-center gap-2">
        <span id="authStatus" class="text-muted small"></span>
        <a
          id="loginLink"
          href="login.html"
          class="btn btn-sm btn-outline-primary"
          >Login</a
        >
        <button id="logoutBtn" class="btn btn-sm btn-outline-secondary d-none">
          Logout
        </button>
      </div>
    </div>

    <div
      class="d-flex justify-content-between align-items-start flex-wrap gap-2"
    >
      <h1 id="placeName" class="mb-0"></h1>

      <div class="d-flex align-items-center gap-2">
        <span id="followCount" class="text-muted small"></span>
        <button
          id="followBtn"
          class="btn btn-sm btn-outline-dark d-none"
        ></button>
      </div>
    </div>

    <!-- Filter bar -->
    <div class="d-flex flex-wrap gap-2 align-items-center mt-3">
      <div class="btn-group" role="group" aria-label="Post filters">
        <button class="btn btn-sm btn-outline-dark active" data-filter="all">
          All
        </button>
        <button class="btn btn-sm btn-outline-danger" data-filter="alert">
          Alerts
        </button>
        <button class="btn btn-sm btn-outline-primary" data-filter="advice">
          Advice
        </button>
        <button class="btn btn-sm btn-outline-success" data-filter="event">
          Events
        </button>
        <button class="btn btn-sm btn-outline-secondary" data-filter="general">
          General
        </button>
      </div>

      <span id="filterHint" class="text-muted small"></span>
    </div>

    <!-- GH-Mind: Take the wheel -->
    <div class="card mt-3" id="ghMindCard">
      <div class="card-body">
        <div
          class="d-flex flex-wrap gap-2 align-items-center justify-content-between"
        >
          <div class="d-flex flex-wrap gap-2 align-items-center">
            <div class="fw-semibold me-2">Take the wheel:</div>

            <div class="btn-group" role="group" aria-label="GH-Mind modes">
              <button class="btn btn-sm btn-outline-dark" data-mode="bored">
                I‚Äôm bored
              </button>
              <button class="btn btn-sm btn-outline-dark" data-mode="hungry">
                I‚Äôm hungry
              </button>
              <button class="btn btn-sm btn-outline-dark" data-mode="idk">
                I don‚Äôt know
              </button>
            </div>

            <span id="ghHint" class="text-muted small"></span>
          </div>

          <div class="d-flex align-items-center gap-2">
            <span class="text-muted small">Distance</span>
            <select
              id="ghDistance"
              class="form-select form-select-sm"
              style="width: auto"
            >
              <option value="near" selected>Near</option>
              <option value="medium">Medium</option>
              <option value="far">Far</option>
              <option value="any">Any</option>
            </select>
          </div>
        </div>

        <div id="ghSuggestionWrap" class="mt-3 d-none">
          <div class="border rounded p-3">
            <div class="d-flex justify-content-between align-items-start gap-2">
              <div>
                <div id="ghWhy" class="text-muted small mb-1"></div>
                <div id="ghTitle" class="h5 mb-1"></div>
                <div id="ghBody" class="text-muted"></div>
              </div>
              <div class="text-muted small text-nowrap" id="ghMeta"></div>
            </div>

            <div class="mt-3 d-flex flex-wrap gap-2">
              <button id="ghYes" class="btn btn-sm btn-dark">‚úÖ Yes</button>
              <button id="ghNo" class="btn btn-sm btn-outline-dark">
                ‚ùå No
              </button>
              <button id="ghSkip" class="btn btn-sm btn-outline-secondary">
                Not now
              </button>

              <div class="ms-auto d-flex gap-2">
                <button id="ghUp" class="btn btn-sm btn-outline-primary">
                  üëç
                </button>
                <button id="ghDown" class="btn btn-sm btn-outline-secondary">
                  üëé
                </button>
              </div>
            </div>

            <div id="ghMsg" class="text-muted small mt-2"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Post (only shows when logged in) -->
    <div id="createPostCard" class="card mt-3 d-none">
      <div class="card-body">
        <h5 class="card-title">Create a post</h5>

        <form id="postForm" class="mt-3">
          <div class="row g-2">
            <div class="col-12 col-md-3">
              <select id="type" class="form-select" required>
                <option value="general" selected>General</option>
                <option value="advice">Advice</option>
                <option value="event">Event</option>
                <option value="alert">Alert</option>
              </select>
            </div>

            <div class="col-12 col-md-3">
              <select id="topic" class="form-select" required>
                <option value="everyday" selected>Everyday</option>
                <option value="food_drink">Food & Drink</option>
                <option value="outdoors">Outdoors</option>
                <option value="history">History</option>
                <option value="events">Events</option>
                <option value="attractions">Attractions</option>
                <option value="nightlife">Nightlife</option>
                <option value="legends">Legends & Lore</option>
              </select>
            </div>

            <div class="col-12 col-md-6">
              <input
                id="title"
                class="form-control"
                maxlength="120"
                placeholder="Title"
                required
              />
            </div>

            <div class="col-12">
              <textarea
                id="body"
                class="form-control"
                rows="3"
                placeholder="Details (optional)"
              ></textarea>
            </div>

            <div class="col-12 d-flex align-items-center gap-2">
              <button type="submit" class="btn btn-primary">Post</button>
              <span id="postMsg" class="text-muted small"></span>
            </div>
          </div>
        </form>
      </div>
    </div>

    <div id="posts" class="mt-4"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/auth-ui.js"></script>
    <script src="js/place.js"></script>
  </body>
</html>
