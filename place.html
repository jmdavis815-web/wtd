<!doctype html>
<html>
  <head>
    <title>WTD ‚Äì Place</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- GH-Mind polish -->
    <style>
      :root {
        --gh-accent: 99, 102, 241; /* indigo-ish */
        --gh-accent2: 16, 185, 129; /* emerald-ish */
      }

      /* Make GH card feel ‚Äúfeatured‚Äù */
      .gh-hero {
        border: 1px solid rgba(var(--gh-accent), 0.25);
        border-radius: 16px;
        box-shadow:
          0 10px 30px rgba(0, 0, 0, 0.08),
          0 2px 10px rgba(0, 0, 0, 0.06);
        overflow: hidden;
      }

      .gh-hero .gh-hero-head {
        background: linear-gradient(
          90deg,
          rgba(var(--gh-accent), 0.14),
          rgba(var(--gh-accent2), 0.1)
        );
        border-bottom: 1px solid rgba(var(--gh-accent), 0.18);
      }

      .gh-pill-group .btn {
        border-radius: 999px !important;
        padding-left: 0.85rem;
        padding-right: 0.85rem;
      }

      /* When JS adds .active, make it pop */
      .gh-pill-group .btn.active {
        background: rgba(var(--gh-accent), 0.12) !important;
        border-color: rgba(var(--gh-accent), 0.35) !important;
        box-shadow: 0 0 0 4px rgba(var(--gh-accent), 0.1);
      }

      /* Suggestion box: nicer surface */
      .gh-surface {
        border-radius: 14px;
        border: 1px solid rgba(0, 0, 0, 0.08);
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(6px);
      }

      /* Sticky on small screens so it feels like a ‚Äúcontrol bar‚Äù */
      @media (max-width: 575.98px) {
        #ghMindCard {
          position: sticky;
          top: 0.75rem;
          z-index: 10;
        }
      }

      /* Tiny pulse to draw attention once */
      @keyframes ghPulse {
        0% {
          box-shadow: 0 0 0 0 rgba(var(--gh-accent), 0.18);
        }
        100% {
          box-shadow: 0 0 0 14px rgba(var(--gh-accent), 0);
        }
      }
      .gh-attention {
        animation: ghPulse 1.2s ease-out 1;
      }
    </style>
  </head>
  <body class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <a href="index.html">‚Üê Back</a>

      <div class="d-flex align-items-center gap-2">
        <span id="authStatus" class="text-muted small"></span>
        <a
          id="loginLink"
          href="login.html"
          class="btn btn-sm btn-outline-primary"
          >Login</a
        >
        <button id="logoutBtn" class="btn btn-sm btn-outline-secondary d-none">
          Logout
        </button>
      </div>
    </div>

    <div
      class="d-flex justify-content-between align-items-start flex-wrap gap-2"
    >
      <h1 id="placeName" class="mb-0"></h1>

      <div class="d-flex align-items-center gap-2">
        <span id="followCount" class="text-muted small"></span>
        <button
          id="followBtn"
          class="btn btn-sm btn-outline-dark d-none"
        ></button>
      </div>
    </div>

    <!-- GH-Mind: Take the wheel -->
    <div class="card mt-3 gh-hero gh-attention" id="ghMindCard">
      <div class="gh-hero-head px-3 py-2">
        <div
          class="d-flex align-items-center justify-content-between flex-wrap gap-2"
        >
          <div class="d-flex align-items-center gap-2">
            <span class="badge text-bg-dark">GH-Mind</span>
            <div class="fw-semibold">Take the wheel</div>
            <span class="text-muted small">Pick a vibe ‚Üí get a suggestion</span>
          </div>
          <span id="ghHint" class="text-muted small"></span>
        </div>
      </div>
      <div class="card-body">
        <div
          class="d-flex flex-wrap gap-2 align-items-center justify-content-between"
        >
          <div class="d-flex flex-wrap gap-2 align-items-center">
            <div
              class="btn-group gh-pill-group"
              role="group"
              aria-label="GH-Mind modes"
            >
              <button
                class="btn btn-sm btn-outline-dark"
                data-mode="bored"
                type="button"
              >
                I‚Äôm bored
              </button>
              <button
                class="btn btn-sm btn-outline-dark"
                data-mode="hungry"
                type="button"
              >
                I‚Äôm hungry
              </button>
              <button
                class="btn btn-sm btn-outline-dark"
                data-mode="idk"
                type="button"
              >
                I don‚Äôt know
              </button>
            </div>
          </div>

          <div class="d-flex align-items-center gap-2">
            <span class="text-muted small">Distance</span>
            <select
              id="ghDistance"
              class="form-select form-select-sm"
              style="width: auto"
            >
              <option value="near" selected>Near</option>
              <option value="medium">Medium</option>
              <option value="far">Far</option>
              <option value="any">Any</option>
            </select>
          </div>
        </div>

        <div id="ghSuggestionWrap" class="mt-3 d-none">
          <div class="gh-surface p-3">
            <div class="d-flex justify-content-between align-items-start gap-2">
              <div>
                <div id="ghWhy" class="text-muted small mb-1"></div>
                <div id="ghTitle" class="h5 mb-1"></div>
                <div id="ghBody" class="text-muted"></div>
              </div>
              <div class="text-muted small text-nowrap" id="ghMeta"></div>
            </div>

            <div class="mt-3 d-flex flex-wrap gap-2">
              <button id="ghYes" class="btn btn-sm btn-dark" type="button">
                ‚úÖ Yes
              </button>
              <button id="ghNo" class="btn btn-sm btn-outline-dark">
                ‚ùå No
              </button>
              <button id="ghSkip" class="btn btn-sm btn-outline-secondary">
                Not now
              </button>

              <div class="ms-auto d-flex gap-2">
                <button
                  id="ghUp"
                  class="btn btn-sm btn-outline-primary"
                  type="button"
                >
                  üëç
                </button>
                <button
                  id="ghDown"
                  class="btn btn-sm btn-outline-secondary"
                  type="button"
                >
                  üëé
                </button>
              </div>
            </div>

            <div id="ghMsg" class="text-muted small mt-2"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Post (only shows when logged in) -->
    <div id="createPostCard" class="card mt-3 d-none">
      <div class="card-body">
        <h5 class="card-title">Create a post</h5>

        <form id="postForm" class="mt-3">
          <div class="row g-2">
            <div class="col-12 col-md-3">
              <select id="type" class="form-select" required>
                <option value="general" selected>General</option>
                <option value="advice">Advice</option>
                <option value="event">Event</option>
                <option value="alert">Alert</option>
              </select>
            </div>

            <div class="col-12 col-md-3">
              <select id="topic" class="form-select" required>
                <option value="everyday" selected>Everyday</option>
                <option value="food_drink">Food & Drink</option>
                <option value="outdoors">Outdoors</option>
                <option value="history">History</option>
                <option value="events">Entertainment</option>
                <option value="attractions">Attractions</option>
                <option value="nightlife">Nightlife</option>
                <option value="legends">Legends & Lore</option>
              </select>
            </div>

            <div class="col-12 col-md-6">
              <input
                id="title"
                class="form-control"
                maxlength="120"
                placeholder="Title"
                required
              />
            </div>

            <div class="col-12">
              <textarea
                id="body"
                class="form-control"
                rows="3"
                placeholder="Details (optional)"
              ></textarea>
            </div>

            <!-- Event date/time (only shown when type = event) -->
            <div id="eventTimeRow" class="col-12 d-none">
              <div class="row g-2">
                <div class="col-12 col-md-4">
                  <label class="form-label mb-1" for="eventStart">Starts</label>
                  <input
                    id="eventStart"
                    type="datetime-local"
                    class="form-control"
                  />
                  <div class="form-text">Required for events.</div>
                </div>

                <div class="col-12 col-md-4">
                  <label class="form-label mb-1" for="eventEnd">Ends</label>
                  <input
                    id="eventEnd"
                    type="datetime-local"
                    class="form-control"
                  />
                  <div class="form-text">
                    Optional (leave blank if unknown).
                  </div>
                </div>

                <div class="col-12 col-md-4 d-flex align-items-end">
                  <div class="alert alert-light border w-100 mb-0 py-2 small">
                    Times use your device‚Äôs local timezone.
                  </div>
                </div>
              </div>
            </div>

            <div class="col-12 d-flex align-items-center gap-2">
              <button type="submit" class="btn btn-primary">Post</button>
              <span id="postMsg" class="text-muted small"></span>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Filter bar -->
    <div class="d-flex flex-wrap gap-2 align-items-center mt-3">
      <div class="btn-group" role="group" aria-label="Post filters">
        <button class="btn btn-sm btn-outline-dark active" data-filter="all">
          All
        </button>
        <button class="btn btn-sm btn-outline-danger" data-filter="alert">
          Alerts
        </button>
        <button class="btn btn-sm btn-outline-primary" data-filter="advice">
          Advice
        </button>
        <button class="btn btn-sm btn-outline-success" data-filter="event">
          Events
        </button>
        <button class="btn btn-sm btn-outline-secondary" data-filter="general">
          General
        </button>
      </div>

      <span id="filterHint" class="text-muted small"></span>
    </div>

    <div id="posts" class="mt-4"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/auth-ui.js"></script>
    <script src="js/place.js"></script>
  </body>
</html>
